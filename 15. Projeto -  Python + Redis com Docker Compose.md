
# Projeto: Python + Redis com Docker Compose

Este projeto demonstra, de forma prática, como **conectar uma aplicação Python a um Redis** usando **Docker Compose**.  
O foco é entender **arquitetura**, **comunicação entre containers** e **uso real de serviços auxiliares**.

Redis é muito usado para:
- cache
- contadores
- filas
- rate limit
- sessões

---

## 1) Objetivo do projeto

Ao final deste projeto, você será capaz de:
- criar uma aplicação Python simples
- rodar Redis em container
- conectar Python ↔ Redis via rede Docker
- usar Docker Compose para orquestrar tudo
- entender um padrão muito comum em backend real

---

## 2) Arquitetura do projeto

```

┌──────────────┐ ┌──────────────┐  
│ Python │ ─────▶ │ Redis │  
│ (app) │ │ (cache) │  
└──────────────┘ └──────────────┘

```

Pontos importantes:
- Python acessa Redis pelo **nome do serviço**
- Redis não é exposto externamente
- Comunicação ocorre via rede interna do Docker

---

## 3) Estrutura do projeto

```

python-redis/  
├── app/  
│ ├── app.py  
│ ├── requirements.txt  
│ └── Dockerfile  
├── docker-compose.yml  
└── README.md

````

---

## 4) Código da aplicação Python

### `requirements.txt`
```txt
redis
````

---

### `app.py`

```python
import redis
import time

redis_client = redis.Redis(
    host="redis",
    port=6379,
    decode_responses=True
)

while True:
    count = redis_client.incr("contador")
    print(f"Contador atual: {count}")
    time.sleep(2)
```

O que esse código faz:

- conecta no Redis usando o hostname `redis`
- incrementa um contador
- imprime o valor a cada 2 segundos

---

## 5) Dockerfile da aplicação Python

### `Dockerfile`

```dockerfile
FROM python:3.11-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY app.py .

CMD ["python", "app.py"]
```

Boas práticas aplicadas:

- imagem `slim`
- dependências antes do código (cache)
- `--no-cache-dir`
- exec form no `CMD`

---

## 6) Docker Compose do projeto

### `docker-compose.yml`

```yaml
services:
  app:
    build: ./app
    depends_on:
      - redis

  redis:
    image: redis:7
```

O que o Compose faz:

- cria uma rede interna automaticamente
- sobe Redis antes da aplicação
- permite comunicação via hostname `redis`

---

## 7) Subindo o projeto

Na raiz do projeto:

```bash
docker compose up
```

Você verá algo como:

```txt
Contador atual: 1
Contador atual: 2
Contador atual: 3
```

Isso confirma que:

- Python está rodando
- Redis está acessível
- comunicação entre containers funciona

---

## 8) Testando persistência (opcional)

Por padrão, Redis aqui é **volátil**.

Se você parar e subir novamente:

```bash
docker compose down
docker compose up
```

O contador reinicia.

Isso é esperado.

---

## 9) Adicionando volume ao Redis (opcional)

Para persistir dados do Redis:

```yaml
services:
  redis:
    image: redis:7
    volumes:
      - redisdata:/data

volumes:
  redisdata:
```

Agora:

- dados sobrevivem à recriação do container
- padrão comum em produção

---

## 10) Erros comuns nesse projeto

- Usar `localhost` em vez de `redis`
- Expor Redis com `ports` sem necessidade
- Não usar `depends_on`
- Esquecer de instalar a lib `redis`
- Assumir que Redis sempre estará disponível sem retry

---

## 11) Boas práticas aprendidas aqui

- serviços se comunicam por nome
- Redis não precisa ser exposto externamente
- Docker Compose simplifica orquestração
- aplicação não depende do host
- arquitetura é reproduzível

---

## 12) Extensões naturais do projeto

Você pode evoluir esse projeto para:

- Flask + Redis (cache de endpoint)
- Celery + Redis (fila de tarefas)
- Rate limit com Redis
- Sessões de usuário com Redis
- Monitoramento com Redis Insight

---

## 13) Checklist final

-  Python conecta ao Redis via hostname
-  Redis não exposto externamente
-  Dockerfile simples e enxuto
-  Compose define a aplicação inteira
-  Projeto sobe com um comando

---

## 14) Conclusão

Esse projeto representa um **padrão real de mercado**:

- aplicação principal
- serviço auxiliar (Redis)
- comunicação via rede Docker
- orquestração com Compose

Se você entende esse projeto, você já está pronto para:

- projetos multi-container
- stacks backend modernas
- usar cache e filas com segurança

---

## 15) Próximos projetos sugeridos

- Flask + Redis (cache)
- Flask + Celery + Redis
- FastAPI + Redis
- Node.js + Redis
- Python + Redis + PostgreSQL
