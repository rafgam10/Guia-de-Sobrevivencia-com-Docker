
# Nomeando a imagem gerada pelo Docker Compose

Por padrão, o Docker Compose **gera nomes automáticos** para as imagens que ele constrói.  
Isso funciona, mas em projetos reais **nomear explicitamente a imagem é uma boa prática**.

Este guia explica:
- como o Docker Compose nomeia imagens por padrão
- como definir o nome da imagem manualmente
- quando e por que isso é importante
- exemplos práticos

---

## 1) Como o Docker Compose nomeia imagens por padrão

Quando você usa `build:` sem definir `image:`, o Compose cria um nome automático:

Formato geral:
```

_<nome-do-serviço>

````

Exemplo:
```yaml
services:
  api:
    build: .
````

Se o diretório do projeto for `flask-app`, a imagem gerada será algo como:

```
flask-app_api
```

Esse nome:

- depende do nome da pasta
- muda se você renomear o diretório
- não é ideal para produção ou registry

---

## 2) Por que nomear imagens explicitamente

Nomear imagens manualmente permite:

- padronização
- versionamento
- push para registries (Docker Hub, GHCR, etc.)
- uso em CI/CD
- reutilização da imagem fora do Compose

Em projetos profissionais, isso é praticamente obrigatório.

---

## 3) Definindo o nome da imagem com `image`

Para nomear a imagem, use a chave `image:` junto com `build:`.

### Exemplo básico

```yaml
services:
  api:
    image: flask-api
    build: .
```

Agora:

- a imagem se chama `flask-api`
- não depende do nome da pasta
- pode ser reutilizada com `docker run`

---

## 4) Nomeando imagem com namespace e tag

Formato recomendado:

```
usuario-ou-org/nome-da-imagem:tag
```

Exemplo:

```yaml
services:
  api:
    image: minhaorg/flask-api:1.0.0
    build: .
```

Vantagens:

- pronto para push em registry
- controle de versão
- histórico de releases

---

## 5) Usando variáveis de ambiente para nome da imagem

Muito comum em CI/CD.

### `.env`

```env
IMAGE_NAME=minhaorg/flask-api
IMAGE_TAG=1.0.0
```

### `docker-compose.yml`

```yaml
services:
  api:
    image: ${IMAGE_NAME}:${IMAGE_TAG}
    build: .
```

Permite:

- trocar versão sem editar YAML
- usar tags diferentes por ambiente

---

## 6) Nome da imagem vs nome do container

São coisas diferentes.

### Nome da imagem

Definido com:

```yaml
image: flask-api
```

### Nome do container

Definido com:

```yaml
container_name: flask-api-container
```

Diferença:

- imagem → modelo
- container → instância em execução

Em geral:

- nomeie a imagem sempre
- evite `container_name` em projetos escaláveis

---

## 7) Verificando a imagem criada

Após rodar:

```bash
docker compose build
```

Liste as imagens:

```bash
docker images
```

Você verá:

```
minhaorg/flask-api   1.0.0
```

---

## 8) Reutilizando a imagem fora do Compose

Como a imagem tem nome explícito, você pode:

```bash
docker run -p 8000:8000 minhaorg/flask-api:1.0.0
```

Isso não seria prático com nomes automáticos.

---

## 9) Atualizando a imagem

Se você mudar o código:

```bash
docker compose build
docker compose up
```

Se quiser garantir rebuild:

```bash
docker compose build --no-cache
```

---

## 10) Boas práticas de nomeação

- Use letras minúsculas
- Use hífen (`-`) em vez de underscore
- Inclua versão (`:1.0.0`, `:latest`, `:dev`)
- Use namespace (org/usuario)
- Não dependa do nome da pasta

---

## 11) Erros comuns

- Confiar em nomes automáticos
- Esquecer de versionar imagens
- Confundir imagem com container
- Usar `container_name` como substituto de `image`

---

## 12) Exemplo completo (Flask)

```yaml
services:
  api:
    image: minhaorg/flask-api:dev
    build: .
    ports:
      - "8000:8000"
```

---

## 13) Checklist rápido

-  `image:` definido no Compose
-  Nome independente do diretório
-  Tag usada corretamente
-  Pronto para registry
-  Reutilizável fora do Compose

---

## 14) Conclusão

Nomear imagens no Docker Compose:

- evita confusão
- melhora organização
- facilita deploy e CI/CD
- aproxima o projeto de padrões profissionais

É um detalhe pequeno, mas que faz muita diferença conforme o projeto cresce.

---

## 15) Próximos tópicos sugeridos

- Versionamento de imagens
- Docker Compose em CI/CD
- Publicando imagens em registry
- Estratégias de tag (dev, staging, prod)
- Multi-stage build com tags
